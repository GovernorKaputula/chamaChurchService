<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mwila & Chama‚Äôs Wedding | 29.11.2025</title>

    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <nav class="site-navigation sticky-nav">
        <ul>
            <li><a href="#hero">Home</a></li>
            <li><a href="#story">Our Story</a></li>
            <li><a href="#timeline">Timeline</a></li>
            <li><a href="#rsvp">RSVP</a></li>
            <li><a href="#gallery">Gallery</a></li>
        </ul>
    </nav>

    <main>
        <section id="rsvp" class="form-section content-section" data-scroll>
            <h2>RSVP: Will You Join Our Celebration?</h2>
            <p class="readable-text">
                We can't wait to share our special day with you! Kindly confirm your attendance by **15th November 2025**.
            </p>

            <form id="rsvp-form" class="rsvp-form" 
                  action="https://script.google.com/macros/s/AKfycbzy3Nz7vwggV2nTqxhxxm5ZNdR7BS_ILbaSyE0WSQhf2ORsF6nA4crHJ_UXtAmQDcja/exec"
                  method="GET"
                  target="response-iframe"> 
                <div class="form-group">
                    <label for="name">Your Full Name(s)</label>
                    <input type="text" id="name" name="name" required placeholder="e.g., Bright Mulenga" />
                </div>
                
                <div class="form-group attendance-group">
                    <label for="attending">Will you be attending?</label>
                    <select id="attending" name="attending" required>
                        <option value="">-- Please Select --</option>
                        <option value="Yes">Joyfully Attending üéâ</option>
                        <option value="No">Regretfully Declining üòî</option>
                    </select>
                </div>

             <div class="form-group guest-count-group">
                 <label for="guests">Total Number in your party (including yourself)</label>
                 <input 
                  type="number" id="guests"  name="guests"  value="1"  readonly  required 
                 />
             </div>

                
                <div class="form-group">
                    <label for="dietary">Dietary Needs or Allergies (Optional)</label>
                    <textarea id="dietary" name="dietary" rows="3" placeholder="e.g., Vegetarian, Gluten-Free, Nut allergy..."></textarea>
                </div>
                <p class="readable-text">"Gifts In monetary Form Shall Be Highly Aprreciated!"</p>
                <strong><p class="readable-text">Please Note:</p></strong>
                <p class="readable-text">1. This Card is not Transferrable</p>
                <p class="readable-text">2. No Kids Allowed</p>
                <p class="readable-text">3. This is a "one person" card (No Mr And Mrs)</p>
                <p class="readable-text">4. we will not consider any RSVP after **November 15th 2025** </p>
                <button id="rsvp-submit-button" type="submit" class="cta-button pulse">Submit RSVP</button>
            </form>

            <div id="rsvp-message" class="hidden-message"></div>
            <iframe name="response-iframe" id="response-iframe" style="display:none;"></iframe>
        </section>

        </main>

    <footer>
        <p>
            ¬© Mwila & Chama 2025 | #MwilaAndChamaSayIDo
            <br>
            Designed by <a href="https://www.yellowphase.org" target="_blank" rel="noopener noreferrer">Yellowphase</a>
        </p>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // === 1. SCROLL REVEAL (Omitted for brevity) ===
            const scrollElements = document.querySelectorAll("[data-scroll]");
            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add("scrolled");
                        observer.unobserve(entry.target);
                    }
                });
            }, { root: null, threshold: 0.15, rootMargin: "0px 0px -50px 0px" });
            scrollElements.forEach(el => observer.observe(el));

            // === 2. COUNTDOWN TIMER (Omitted for brevity) ===
            const countdownContainer = document.getElementById("countdown-section");
            const countdownDate = new Date("Nov 29, 2025 10:00:00 GMT+02:00").getTime();
            
            const timer = setInterval(() => {
                const now = new Date().getTime();
                const distance = countdownDate - now;
                
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                const daysEl = document.getElementById("days");
                const hoursEl = document.getElementById("hours");
                const minutesEl = document.getElementById("minutes");
                const secondsEl = document.getElementById("seconds");

                if (daysEl) daysEl.textContent = days.toString().padStart(2, '0');
                if (hoursEl) hoursEl.textContent = hours.toString().padStart(2, '0');
                if (minutesEl) minutesEl.textContent = minutes.toString().padStart(2, '0');
                if (secondsEl) secondsEl.textContent = seconds.toString().padStart(2, '0');

                if (distance < 0) {
                    clearInterval(timer);
                    if (countdownContainer) {
                        countdownContainer.innerHTML = "<h2>The celebration is underway!</h2>";
                    }
                }
            }, 1000);

            // === 3. GOOGLE SHEETS RSVP SUBMISSION (MODIFIED FOR IFRAME) ===
            const form = document.getElementById('rsvp-form');
            const messageDiv = document.getElementById('rsvp-message');
            const submitButton = document.getElementById('rsvp-submit-button');
            const iframe = document.getElementById('response-iframe');


            form.addEventListener('submit', (e) => {
                // --- Client-side Validation ---
                const nameInput = document.getElementById('name').value.trim();
                const attendingStatusValue = document.getElementById('attending').value;
                
                if (nameInput === "" || attendingStatusValue === "") {
                    // Pre-submission validation. We use e.preventDefault() only here if it fails.
                    e.preventDefault(); 
                    messageDiv.textContent = "‚ö†Ô∏è Please fill in your full name and select an attendance status.";
                    messageDiv.style.display = 'block';
                    submitButton.disabled = false;
                    return;
                }
                
                // --- Submission Process ---
                // Set loading message and disable button
                messageDiv.textContent = "‚è≥ Submitting your RSVP...";
                messageDiv.style.display = 'block';
                submitButton.disabled = true;

                // This function is executed when the hidden iframe successfully loads the response
                // from the Google Apps Script (which is the successful redirect).
                iframe.onload = function() {
                    messageDiv.textContent = "‚úÖ Your RSVP has been submitted successfully! Thank you!";
                    messageDiv.style.display = 'block'; 
                    form.reset(); // Clear the form fields
                    submitButton.disabled = false;
                    
                    // Cleanup and scroll
                    iframe.onload = null; 
                    document.getElementById('rsvp').scrollIntoView({ behavior: 'smooth' });
                };

                // The form submits normally because e.preventDefault() was not executed, 
                // but the result loads into the iframe, keeping the main page static.
            });
        });
    </script>
</body>
</html>
